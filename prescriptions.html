<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prescriptions Recip-e - DentalCockpit Pro</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #0066FF;
            --primary-dark: #0052CC;
            --secondary: #00C896;
            --danger: #FF3B30;
            --warning: #FF9500;
            --success: #34C759;
            --purple: #8B5CF6;
            --recipe-blue: #0052A3;
            --bg-main: #0A0E1A;
            --bg-card: #141B2D;
            --bg-hover: #1E2740;
            --text-primary: #FFFFFF;
            --text-secondary: #8B92A8;
            --border: #2A3347;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        [data-theme="light"] {
            --bg-main: #F5F7FA;
            --bg-card: #FFFFFF;
            --bg-hover: #E8ECF1;
            --text-primary: #1A1D29;
            --text-secondary: #6B7280;
            --border: #E5E7EB;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Inter', sans-serif;
            background: var(--bg-main);
            color: var(--text-primary);
            overflow-x: hidden;
        }

        .app-container {
            display: grid;
            grid-template-columns: 280px 1fr;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            background: var(--bg-card);
            border-right: 1px solid var(--border);
            padding: 24px 16px;
            display: flex;
            flex-direction: column;
            position: fixed;
            height: 100vh;
            width: 280px;
            overflow-y: auto;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 8px 12px;
            margin-bottom: 32px;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
        }

        .logo-text {
            font-size: 19px;
            font-weight: 700;
        }

        .nav-section {
            margin-bottom: 24px;
        }

        .nav-title {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--text-secondary);
            padding: 0 12px;
            margin-bottom: 8px;
            letter-spacing: 0.5px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 12px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 14px;
        }

        .nav-item:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .nav-item.active {
            background: var(--primary);
            color: var(--text-primary);
        }

        /* Main Content */
        .main-content {
            margin-left: 280px;
            display: flex;
            flex-direction: column;
        }

        .topbar {
            background: var(--bg-card);
            border-bottom: 1px solid var(--border);
            padding: 16px 32px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        .search-bar {
            flex: 1;
            max-width: 500px;
            position: relative;
        }

        .search-bar input {
            width: 100%;
            padding: 12px 16px 12px 44px;
            background: var(--bg-main);
            border: 1px solid var(--border);
            border-radius: 10px;
            color: var(--text-primary);
            font-size: 14px;
            transition: all 0.2s;
        }

        .search-bar input:focus {
            outline: none;
            border-color: var(--primary);
            background: var(--bg-hover);
        }

        .search-icon {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
        }

        .topbar-actions {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .icon-btn {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-main);
            border: 1px solid var(--border);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }

        .icon-btn:hover {
            background: var(--bg-hover);
            border-color: var(--primary);
            transform: translateY(-2px);
        }

        .badge {
            position: absolute;
            top: -4px;
            right: -4px;
            background: var(--danger);
            color: white;
            font-size: 10px;
            font-weight: 700;
            padding: 2px 6px;
            border-radius: 10px;
        }

        /* Content Area */
        .content {
            padding: 32px;
            display: grid;
            gap: 24px;
        }

        /* Header Section */
        .page-header {
            background: linear-gradient(135deg, var(--recipe-blue), #0066CC);
            border-radius: 20px;
            padding: 32px;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-content h1 {
            font-size: 32px;
            font-weight: 800;
            margin-bottom: 8px;
        }

        .header-content p {
            font-size: 15px;
            opacity: 0.95;
        }

        .recipe-badge {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            padding: 16px 24px;
            border-radius: 12px;
            text-align: center;
        }

        .recipe-badge-title {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
            opacity: 0.9;
            margin-bottom: 4px;
        }

        .recipe-badge-status {
            font-size: 20px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
            justify-content: center;
        }

        /* Patient Info Card */
        .patient-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 24px;
        }

        .patient-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .patient-avatar {
            width: 70px;
            height: 70px;
            background: rgba(0, 102, 255, 0.15);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            border: 3px solid var(--border);
        }

        .patient-info h2 {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .patient-meta {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
        }

        .meta-item {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .meta-label {
            font-size: 12px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .meta-value {
            font-size: 14px;
            font-weight: 600;
        }

        /* Prescription Form */
        .prescription-form {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 28px;
        }

        .form-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--border);
        }

        .form-title {
            font-size: 22px;
            font-weight: 700;
        }

        .form-group {
            margin-bottom: 24px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            font-size: 14px;
        }

        .form-input, .form-textarea, .form-select {
            width: 100%;
            padding: 12px 16px;
            background: var(--bg-main);
            border: 1px solid var(--border);
            border-radius: 10px;
            color: var(--text-primary);
            font-size: 14px;
            font-family: inherit;
            transition: all 0.2s;
        }

        .form-input:focus, .form-textarea:focus, .form-select:focus {
            outline: none;
            border-color: var(--primary);
            background: var(--bg-hover);
        }

        .autocomplete-container {
            position: relative;
        }

        .autocomplete-results {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 10px;
            margin-top: 4px;
            max-height: 300px;
            overflow-y: auto;
            z-index: 1000;
            box-shadow: var(--shadow);
            display: none;
        }

        .autocomplete-results.active {
            display: block;
        }

        .autocomplete-item {
            padding: 12px 16px;
            cursor: pointer;
            transition: all 0.2s;
            border-bottom: 1px solid var(--border);
        }

        .autocomplete-item:hover {
            background: var(--bg-hover);
        }

        .autocomplete-item:last-child {
            border-bottom: none;
        }

        .drug-name {
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 4px;
        }

        .drug-details {
            font-size: 12px;
            color: var(--text-secondary);
        }

        /* Selected Medications */
        .selected-medications {
            margin-top: 24px;
        }

        .medication-item {
            background: var(--bg-main);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
            position: relative;
        }

        .medication-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 12px;
        }

        .medication-name {
            font-size: 16px;
            font-weight: 700;
            color: var(--primary);
        }

        .remove-btn {
            background: var(--danger);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.2s;
        }

        .remove-btn:hover {
            opacity: 0.8;
        }

        .medication-dosage {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-top: 12px;
        }

        .dosage-input {
            padding: 8px 12px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 13px;
        }

        /* Interaction Warnings */
        .warnings-panel {
            background: rgba(255, 149, 0, 0.1);
            border: 2px solid var(--warning);
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }

        .warning-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 16px;
            font-weight: 700;
            color: var(--warning);
            margin-bottom: 12px;
        }

        .warning-item {
            background: var(--bg-card);
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 8px;
            font-size: 13px;
        }

        /* AI Suggestions */
        .ai-suggestions-panel {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 24px;
        }

        .ai-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }

        .ai-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #6366F1, #8B5CF6);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .ai-title {
            font-size: 18px;
            font-weight: 700;
        }

        .suggestion-item {
            background: var(--bg-main);
            border-left: 3px solid var(--purple);
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .suggestion-item:hover {
            background: var(--bg-hover);
        }

        .suggestion-drug {
            font-weight: 600;
            font-size: 15px;
            margin-bottom: 6px;
        }

        .suggestion-reason {
            font-size: 13px;
            color: var(--text-secondary);
        }

        /* Recip-e Section */
        .recipe-panel {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 28px;
        }

        .recipe-header {
            text-align: center;
            margin-bottom: 24px;
        }

        .recipe-logo {
            font-size: 48px;
            margin-bottom: 12px;
        }

        .recipe-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--recipe-blue);
        }

        .qr-code {
            width: 220px;
            height: 220px;
            background: white;
            border: 3px solid var(--border);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 180px;
        }

        .recipe-id {
            text-align: center;
            font-size: 18px;
            font-weight: 700;
            font-family: monospace;
            letter-spacing: 2px;
            color: var(--primary);
            padding: 12px;
            background: var(--bg-main);
            border-radius: 8px;
            margin-bottom: 16px;
        }

        .recipe-status {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px;
            background: rgba(52, 199, 89, 0.1);
            border-radius: 8px;
            color: var(--success);
            font-weight: 600;
        }

        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--success);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.1); }
        }

        /* Prescription History */
        .history-panel {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 24px;
        }

        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .history-title {
            font-size: 20px;
            font-weight: 700;
        }

        .history-item {
            background: var(--bg-main);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .history-item:hover {
            background: var(--bg-hover);
            border-color: var(--primary);
        }

        .history-date {
            font-size: 14px;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 8px;
        }

        .history-drugs {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 6px;
        }

        .history-recipe-id {
            font-size: 12px;
            font-family: monospace;
            color: var(--text-secondary);
        }

        /* Buttons */
        .btn {
            padding: 14px 28px;
            border-radius: 12px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 10px;
            justify-content: center;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 102, 255, 0.4);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: var(--bg-hover);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--bg-main);
            border-color: var(--primary);
        }

        .btn-actions {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            margin-top: 24px;
        }

        /* Drug Info Modal */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.85);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            backdrop-filter: blur(8px);
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: var(--bg-card);
            border-radius: 24px;
            padding: 32px;
            max-width: 800px;
            width: 90%;
            max-height: 85vh;
            overflow-y: auto;
            border: 1px solid var(--border);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .modal-title {
            font-size: 24px;
            font-weight: 700;
        }

        .close-btn {
            width: 36px;
            height: 36px;
            border-radius: 10px;
            border: none;
            background: var(--bg-main);
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 20px;
            transition: all 0.2s;
        }

        .close-btn:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .drug-info-section {
            margin-bottom: 24px;
        }

        .drug-info-title {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 12px;
            color: var(--primary);
        }

        .drug-info-content {
            font-size: 14px;
            line-height: 1.7;
            color: var(--text-secondary);
        }

        .contraindication-list {
            list-style: none;
            padding: 0;
        }

        .contraindication-list li {
            padding: 8px 12px;
            background: var(--bg-main);
            border-radius: 6px;
            margin-bottom: 6px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* Loading */
        .loading-overlay {
            position: fixed;
            inset: 0;
            background: rgba(10, 14, 26, 0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 3000;
        }

        .loading-overlay.active {
            display: flex;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Dosage Calculator */
        .calculator-panel {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 24px;
        }

        .calculator-inputs {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-bottom: 20px;
        }

        .calculator-result {
            background: rgba(0, 102, 255, 0.1);
            border: 2px solid var(--primary);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }

        .result-value {
            font-size: 32px;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 8px;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .app-container {
                grid-template-columns: 1fr;
            }

            .sidebar {
                transform: translateX(-100%);
                position: fixed;
                z-index: 1000;
            }

            .sidebar.active {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .patient-meta {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="logo">
                <div class="logo-icon">ü¶∑</div>
                <div class="logo-text">DentalCockpit Pro</div>
            </div>
            <div style="text-align: center; padding: 10px 0; margin-bottom: 20px; border-bottom: 1px solid var(--border);">
                <div style="font-size: 10px; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 1px;">Powered by</div>
                <div style="font-size: 14px; font-weight: 700; color: var(--primary); margin-top: 4px;">RCE</div>
            </div>

            <nav>
                <div class="nav-section">
                    <div class="nav-title">Navigation</div>
                    <a href="index.html" class="nav-item">
                        <span>üìä</span>
                        <span>Dashboard Patient</span>
                    </a>
                    <a href="patients.html" class="nav-item">
                        <span>üë•</span>
                        <span>Patients</span>
                    </a>
                    <a href="agenda.html" class="nav-item">
                        <span>üìÖ</span>
                        <span>Agenda</span>
                    </a>
                    <a href="treatment.html" class="nav-item">
                        <span>üéØ</span>
                        <span>Plan de Traitement</span>
                    </a>
                </div>

                <div class="nav-section">
                    <div class="nav-title">Clinique</div>
                    <a href="dental-chart.html" class="nav-item">
                        <span>ü¶∑</span>
                        <span>Sch√©ma Dentaire</span>
                    </a>
                    <a href="paro.html" class="nav-item">
                        <span>üìä</span>
                        <span>Parodontologie</span>
                    </a>
                    <a href="ortho.html" class="nav-item">
                        <span>üîß</span>
                        <span>Orthodontie</span>
                    </a>
                    <a href="prescriptions.html" class="nav-item active">
                        <span>üíä</span>
                        <span>Prescriptions</span>
                    </a>
                </div>

                <div class="nav-section">
                    <div class="nav-title">Imagerie M√©dicale</div>
                    <a href="xrays.html" class="nav-item">
                        <span>üì∑</span>
                        <span>Radiographies X</span>
                    </a>
                    <a href="scanner3d.html" class="nav-item">
                        <span>üî¨</span>
                        <span>Scanner 3D</span>
                    </a>
                    <a href="photos.html" class="nav-item">
                        <span>üñºÔ∏è</span>
                        <span>Photos Intra-orales</span>
                    </a>
                    <a href="camera.html" class="nav-item">
                        <span>üì∏</span>
                        <span>Cam√©ra Temps R√©el</span>
                    </a>
                </div>

                <div class="nav-section">
                    <div class="nav-title">Intelligence Artificielle</div>
                    <a href="ai-analysis.html" class="nav-item">
                        <span>ü§ñ</span>
                        <span>Analyses IA</span>
                    </a>
                    <a href="ai-reports.html" class="nav-item">
                        <span>üìà</span>
                        <span>Rapports Intelligents</span>
                    </a>
                    <a href="ai-history.html" class="nav-item">
                        <span>üîÑ</span>
                        <span>Historique Complet IA</span>
                    </a>
                    <a href="ai-realtime.html" class="nav-item">
                        <span>‚ö°</span>
                        <span>IA Temps R√©el</span>
                    </a>
                </div>

                <div class="nav-section">
                    <div class="nav-title">Administration</div>
                    <a href="inami.html" class="nav-item">
                        <span>üí≥</span>
                        <span>INAMI / e-Health</span>
                    </a>
                    <a href="mutuelles.html" class="nav-item">
                        <span>üè•</span>
                        <span>Mutuelles</span>
                    </a>
                    <a href="certificates.html" class="nav-item">
                        <span>üìÑ</span>
                        <span>Certificats</span>
                    </a>
                    <a href="billing.html" class="nav-item">
                        <span>üìä</span>
                        <span>Facturation</span>
                    </a>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Top Bar -->
            <div class="topbar">
                <div class="search-bar">
                    <span class="search-icon">üîç</span>
                    <input type="text" placeholder="Rechercher m√©dicament, patient, prescription...">
                </div>
                <div class="topbar-actions">
                    <div class="icon-btn" onclick="toggleTheme()" id="themeToggle" title="Changer le th√®me">
                        üåô
                    </div>
                    <div class="icon-btn">
                        üîî
                        <span class="badge">3</span>
                    </div>
                    <div class="icon-btn">‚öôÔ∏è</div>
                    <div class="icon-btn">üë§</div>
                </div>
            </div>

            <!-- Content -->
            <div class="content">
                <!-- Page Header -->
                <div class="page-header">
                    <div class="header-content">
                        <h1>üíä Prescription √âlectronique Recip-e</h1>
                        <p>Syst√®me int√©gr√© de prescription √©lectronique conforme e-Health Belgique</p>
                    </div>
                    <div class="recipe-badge">
                        <div class="recipe-badge-title">Connexion e-Health</div>
                        <div class="recipe-badge-status">
                            <span class="status-dot"></span>
                            <span>Connect√©</span>
                        </div>
                    </div>
                </div>

                <!-- Patient Info -->
                <div class="patient-card">
                    <div class="patient-header">
                        <div class="patient-avatar">üë§</div>
                        <div style="flex: 1;">
                            <div class="patient-info">
                                <h2>Marie Dubois</h2>
                                <div style="color: var(--text-secondary); font-size: 14px;">Patiente active</div>
                            </div>
                        </div>
                    </div>
                    <div class="patient-meta">
                        <div class="meta-item">
                            <div class="meta-label">NISS</div>
                            <div class="meta-value">85.07.30-123.45</div>
                        </div>
                        <div class="meta-item">
                            <div class="meta-label">Date de naissance</div>
                            <div class="meta-value">30/07/1985 (39 ans)</div>
                        </div>
                        <div class="meta-item">
                            <div class="meta-label">Poids / √Çge</div>
                            <div class="meta-value">65 kg / 39 ans</div>
                        </div>
                        <div class="meta-item">
                            <div class="meta-label">Allergies</div>
                            <div class="meta-value" style="color: var(--danger);">‚ö†Ô∏è P√©nicilline, Latex</div>
                        </div>
                        <div class="meta-item">
                            <div class="meta-label">Mutuelle</div>
                            <div class="meta-value" style="color: var(--success);">‚úì Mutuelle Chr√©tienne</div>
                        </div>
                        <div class="meta-item">
                            <div class="meta-label">Conditions</div>
                            <div class="meta-value">Diab√®te Type 2</div>
                        </div>
                    </div>
                </div>

                <!-- Main Grid Layout -->
                <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 24px;">
                    <!-- Left Column: Prescription Form -->
                    <div>
                        <!-- AI Suggestions -->
                        <div class="ai-suggestions-panel">
                            <div class="ai-header">
                                <div class="ai-icon">ü§ñ</div>
                                <div>
                                    <div class="ai-title">Suggestions IA bas√©es sur l'anamn√®se</div>
                                    <div style="font-size: 13px; color: var(--text-secondary);">Analyse du diagnostic: Douleur dentaire, pulpite probable</div>
                                </div>
                            </div>
                            <div class="suggestion-item" onclick="addSuggestion('Ibuprofen 600mg')">
                                <div class="suggestion-drug">üíä Ibuprofen 600mg</div>
                                <div class="suggestion-reason">Anti-inflammatoire pour douleur dentaire aigu√´ - 3x/jour pendant 5 jours</div>
                            </div>
                            <div class="suggestion-item" onclick="addSuggestion('Paracetamol 1000mg')">
                                <div class="suggestion-drug">üíä Paracetamol 1000mg</div>
                                <div class="suggestion-reason">Analg√©sique en compl√©ment - Compatible avec diab√®te - 4x/jour si besoin</div>
                            </div>
                            <div class="suggestion-item" onclick="addSuggestion('Chlorhexidine 0.2%')">
                                <div class="suggestion-drug">üíä Chlorhexidine 0.2% bain de bouche</div>
                                <div class="suggestion-reason">Antiseptique local - 2x/jour apr√®s brossage - 7 jours</div>
                            </div>
                        </div>

                        <!-- Prescription Form -->
                        <div class="prescription-form">
                            <div class="form-header">
                                <div class="form-title">üìù Nouvelle Prescription</div>
                                <div style="font-size: 13px; color: var(--text-secondary);">
                                    <span id="prescriptionDate">12/11/2025</span>
                                </div>
                            </div>

                            <!-- Drug Search -->
                            <div class="form-group">
                                <label class="form-label">Rechercher m√©dicament</label>
                                <div class="autocomplete-container">
                                    <input
                                        type="text"
                                        class="form-input"
                                        id="drugSearch"
                                        placeholder="Tapez le nom du m√©dicament..."
                                        onkeyup="searchDrugs(this.value)"
                                        onfocus="searchDrugs(this.value)"
                                    >
                                    <div class="autocomplete-results" id="autocompleteResults"></div>
                                </div>
                            </div>

                            <!-- Selected Medications -->
                            <div class="selected-medications" id="selectedMedications">
                                <!-- Medications will be added here dynamically -->
                            </div>

                            <!-- Interaction Warnings -->
                            <div id="warningsContainer"></div>

                            <!-- Action Buttons -->
                            <div class="btn-actions">
                                <button class="btn btn-success" onclick="generateRecipe()">
                                    üìã G√©n√©rer Prescription Recip-e
                                </button>
                                <button class="btn btn-secondary" onclick="saveDraft()">
                                    üíæ Sauvegarder brouillon
                                </button>
                                <button class="btn btn-secondary" onclick="resetForm()">
                                    üîÑ R√©initialiser
                                </button>
                            </div>
                        </div>

                        <!-- Dosage Calculator -->
                        <div class="calculator-panel">
                            <div class="form-header">
                                <div class="form-title">üßÆ Calculateur de Dosage</div>
                            </div>
                            <div class="calculator-inputs">
                                <div class="form-group" style="margin: 0;">
                                    <label class="form-label">Poids du patient (kg)</label>
                                    <input type="number" class="form-input" id="patientWeight" value="65">
                                </div>
                                <div class="form-group" style="margin: 0;">
                                    <label class="form-label">M√©dicament</label>
                                    <select class="form-select" id="calcDrug" onchange="calculateDosage()">
                                        <option value="">S√©lectionner...</option>
                                        <option value="ibuprofen">Ibuprofen</option>
                                        <option value="paracetamol">Paracetamol</option>
                                        <option value="amoxicillin">Amoxicilline</option>
                                    </select>
                                </div>
                            </div>
                            <div class="calculator-result" id="dosageResult" style="display: none;">
                                <div class="result-value" id="resultValue">600 mg</div>
                                <div style="color: var(--text-secondary);">Dose recommand√©e par prise</div>
                            </div>
                        </div>
                    </div>

                    <!-- Right Column: Recip-e & History -->
                    <div>
                        <!-- Recip-e Preview -->
                        <div class="recipe-panel" id="recipePanel" style="display: none;">
                            <div class="recipe-header">
                                <div class="recipe-logo">üìã</div>
                                <div class="recipe-title">Prescription Recip-e</div>
                                <div style="font-size: 13px; color: var(--text-secondary); margin-top: 4px;">
                                    Plateforme e-Health Belgique
                                </div>
                            </div>

                            <div class="qr-code" id="qrCode">
                                üì±
                            </div>

                            <div class="recipe-id" id="recipeId">
                                BE-XXXX-XXXX-XXXX
                            </div>

                            <div class="recipe-status">
                                <span class="status-dot"></span>
                                <span>Prescription active</span>
                            </div>

                            <div class="btn-actions" style="margin-top: 20px;">
                                <button class="btn btn-primary" onclick="sendToPharmacy()">
                                    üì§ Envoyer √† la pharmacie
                                </button>
                                <button class="btn btn-secondary" onclick="printPrescription()">
                                    üñ®Ô∏è Imprimer
                                </button>
                                <button class="btn btn-secondary" onclick="exportPDF()">
                                    üìÑ Export PDF
                                </button>
                            </div>

                            <div style="margin-top: 20px; padding: 16px; background: var(--bg-main); border-radius: 8px; font-size: 12px; color: var(--text-secondary);">
                                <strong>Tracking e-Health:</strong><br>
                                Statut: Transmis ‚úì<br>
                                Validit√©: 90 jours<br>
                                D√©livrances: 0/1
                            </div>
                        </div>

                        <!-- Prescription History -->
                        <div class="history-panel">
                            <div class="history-header">
                                <div class="history-title">üìú Historique</div>
                                <button class="btn btn-secondary" style="padding: 8px 16px; font-size: 13px;">
                                    Voir tout
                                </button>
                            </div>

                            <div class="history-item" onclick="viewPrescription('RX-2025-1145')">
                                <div class="history-date">08/11/2025</div>
                                <div class="history-drugs">
                                    <strong>Amoxicilline 500mg</strong> - 3x/jour, 7 jours<br>
                                    <strong>Paracetamol 1000mg</strong> - Si besoin
                                </div>
                                <div class="history-recipe-id">ID: BE-2025-1145-RXDE</div>
                            </div>

                            <div class="history-item" onclick="viewPrescription('RX-2025-1089')">
                                <div class="history-date">15/10/2025</div>
                                <div class="history-drugs">
                                    <strong>Ibuprofen 600mg</strong> - 3x/jour, 5 jours<br>
                                    <strong>Chlorhexidine 0.2%</strong> - Bain de bouche
                                </div>
                                <div class="history-recipe-id">ID: BE-2025-1089-RXDE</div>
                            </div>

                            <div class="history-item" onclick="viewPrescription('RX-2025-0923')">
                                <div class="history-date">02/09/2025</div>
                                <div class="history-drugs">
                                    <strong>Co-Amoxiclav 875/125mg</strong> - 2x/jour, 7 jours<br>
                                    <strong>Metronidazole 500mg</strong> - 3x/jour
                                </div>
                                <div class="history-recipe-id">ID: BE-2025-0923-RXDE</div>
                            </div>

                            <div class="history-item" onclick="viewPrescription('RX-2025-0756')">
                                <div class="history-date">18/07/2025</div>
                                <div class="history-drugs">
                                    <strong>Tramadol 50mg</strong> - 4x/jour si besoin
                                </div>
                                <div class="history-recipe-id">ID: BE-2025-0756-RXDE</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Drug Info Modal -->
    <div class="modal-overlay" id="drugInfoModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title" id="modalDrugName">Ibuprofen 600mg</div>
                <button class="close-btn" onclick="closeDrugInfo()">‚úï</button>
            </div>

            <div class="drug-info-section">
                <div class="drug-info-title">üíä Indications</div>
                <div class="drug-info-content" id="modalIndications">
                    Traitement symptomatique des douleurs d'intensit√© l√©g√®re √† mod√©r√©e et/ou des √©tats f√©briles.
                    Particuli√®rement efficace dans les douleurs dentaires post-op√©ratoires et inflammations.
                </div>
            </div>

            <div class="drug-info-section">
                <div class="drug-info-title">‚ö†Ô∏è Contre-indications</div>
                <div class="drug-info-content">
                    <ul class="contraindication-list" id="modalContraindications">
                        <li>üö´ Allergie aux AINS</li>
                        <li>üö´ Ulc√®re gastroduod√©nal actif</li>
                        <li>üö´ Insuffisance cardiaque s√©v√®re</li>
                        <li>üö´ Insuffisance r√©nale s√©v√®re</li>
                        <li>üö´ 3√®me trimestre de grossesse</li>
                    </ul>
                </div>
            </div>

            <div class="drug-info-section">
                <div class="drug-info-title">‚ö° Effets secondaires</div>
                <div class="drug-info-content" id="modalSideEffects">
                    <strong>Fr√©quents:</strong> Troubles gastro-intestinaux, naus√©es, dyspepsie<br>
                    <strong>Peu fr√©quents:</strong> Maux de t√™te, vertiges, √©ruptions cutan√©es<br>
                    <strong>Rares:</strong> Ulc√©ration gastrique, r√©actions allergiques s√©v√®res
                </div>
            </div>

            <div class="drug-info-section">
                <div class="drug-info-title">üìã Posologie standard</div>
                <div class="drug-info-content" id="modalDosage">
                    <strong>Adultes:</strong> 400-600mg, 3 fois par jour (max 2400mg/jour)<br>
                    <strong>Administration:</strong> Pendant ou apr√®s les repas<br>
                    <strong>Dur√©e:</strong> Traitement le plus court possible (g√©n√©ralement 3-5 jours)
                </div>
            </div>

            <div class="drug-info-section">
                <div class="drug-info-title">üîÑ Interactions m√©dicamenteuses</div>
                <div class="drug-info-content" id="modalInteractions">
                    Anticoagulants, autres AINS, cortico√Ødes, antid√©presseurs ISRS, diur√©tiques, antihypertenseurs.
                    Surveillance n√©cessaire en cas de co-prescription.
                </div>
            </div>

            <button class="btn btn-primary" onclick="closeDrugInfo()">Fermer</button>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div style="text-align: center;">
            <div class="loading-spinner"></div>
            <div style="margin-top: 20px; font-size: 16px; font-weight: 600;" id="loadingText">
                G√©n√©ration prescription Recip-e...
            </div>
            <div style="margin-top: 8px; font-size: 13px; color: var(--text-secondary);">
                Connexion √† e-Health Belgique
            </div>
        </div>
    </div>

    <script>
        // Belgian medications database
        const belgianDrugs = [
            {
                name: 'Amoxicilline 500mg',
                category: 'Antibiotique',
                indication: 'Infections bact√©riennes dentaires',
                contraindications: ['Allergie p√©nicilline', 'Mononucl√©ose infectieuse'],
                sideEffects: 'Diarrh√©e, naus√©es, r√©actions allergiques',
                dosage: '500mg 3x/jour pendant 7 jours',
                interactions: ['M√©thotrexate', 'Anticoagulants oraux']
            },
            {
                name: 'Ibuprofen 600mg',
                category: 'Anti-inflammatoire (AINS)',
                indication: 'Douleur et inflammation dentaire',
                contraindications: ['Ulc√®re gastrique actif', 'Insuffisance r√©nale s√©v√®re', 'Allergie AINS'],
                sideEffects: 'Troubles gastro-intestinaux, maux de t√™te',
                dosage: '600mg 3x/jour pendant 3-5 jours',
                interactions: ['Anticoagulants', 'Cortico√Ødes', 'Autres AINS']
            },
            {
                name: 'Paracetamol 1000mg',
                category: 'Analg√©sique',
                indication: 'Douleur l√©g√®re √† mod√©r√©e',
                contraindications: ['Insuffisance h√©patique s√©v√®re'],
                sideEffects: 'Rares aux doses th√©rapeutiques',
                dosage: '1000mg 3-4x/jour (max 4g/jour)',
                interactions: ['Warfarine (surveillance INR)']
            },
            {
                name: 'Chlorhexidine 0.2% bain de bouche',
                category: 'Antiseptique local',
                indication: 'Pr√©vention infections post-op√©ratoires',
                contraindications: ['Hypersensibilit√© chlorhexidine'],
                sideEffects: 'Coloration dentaire r√©versible, alt√©ration go√ªt temporaire',
                dosage: '10-15ml en rin√ßage 2x/jour apr√®s brossage',
                interactions: ['Aucune interaction syst√©mique majeure']
            },
            {
                name: 'Co-Amoxiclav 875/125mg',
                category: 'Antibiotique (association)',
                indication: 'Infections r√©sistantes, abc√®s dentaires',
                contraindications: ['Allergie p√©nicilline', 'Ant√©c√©dent ict√®re'],
                sideEffects: 'Diarrh√©e, naus√©es, h√©patite (rare)',
                dosage: '875/125mg 2x/jour pendant 7 jours',
                interactions: ['Allopurinol', 'Anticoagulants']
            },
            {
                name: 'Metronidazole 500mg',
                category: 'Antibiotique (ana√©robies)',
                indication: 'Infections ana√©robies parodontales',
                contraindications: ['Alcoolisme actif', 'Grossesse 1er trimestre'],
                sideEffects: 'Go√ªt m√©tallique, naus√©es, neuropathie p√©riph√©rique (long terme)',
                dosage: '500mg 3x/jour pendant 7 jours',
                interactions: ['Alcool (effet disulfirame)', 'Warfarine', 'Lithium']
            },
            {
                name: 'Tramadol 50mg',
                category: 'Analg√©sique opio√Øde',
                indication: 'Douleur mod√©r√©e √† s√©v√®re',
                contraindications: ['Insuffisance respiratoire', '√âpilepsie non contr√¥l√©e', 'IMAO'],
                sideEffects: 'Naus√©es, vertiges, constipation, somnolence',
                dosage: '50-100mg toutes les 4-6h si besoin (max 400mg/jour)',
                interactions: ['ISRS', 'Antid√©presseurs', 'Carbamaz√©pine', 'Alcool']
            },
            {
                name: 'Azithromycine 500mg',
                category: 'Antibiotique (macrolide)',
                indication: 'Alternative si allergie p√©nicilline',
                contraindications: ['Allergie macrolides', 'Troubles h√©patiques s√©v√®res'],
                sideEffects: 'Troubles digestifs, allongement QT',
                dosage: '500mg 1x/jour pendant 3 jours',
                interactions: ['M√©dicaments allongeant le QT', 'Ergotamine']
            },
            {
                name: 'Prednisolone 20mg',
                category: 'Cortico√Øde',
                indication: 'Inflammation s√©v√®re post-op√©ratoire',
                contraindications: ['Infections non contr√¥l√©es', 'Ulc√®re gastrique'],
                sideEffects: 'Hyperglyc√©mie, r√©tention hydrique, troubles du sommeil',
                dosage: '20-40mg/jour pendant 3-5 jours avec d√©croissance',
                interactions: ['AINS', 'Antidiab√©tiques', 'Vaccins vivants']
            },
            {
                name: 'Lidocaine gel 2%',
                category: 'Anesth√©sique local',
                indication: 'Douleur locale, ulc√©rations buccales',
                contraindications: ['Allergie anesth√©siques locaux type amide'],
                sideEffects: 'R√©actions allergiques locales (rares)',
                dosage: 'Application locale 3-4x/jour',
                interactions: ['Aucune interaction syst√©mique significative']
            }
        ];

        let selectedMedications = [];
        let prescriptionCounter = 1146;

        // Search drugs with autocomplete
        function searchDrugs(query) {
            const results = document.getElementById('autocompleteResults');

            if (query.length < 2) {
                results.classList.remove('active');
                return;
            }

            const filtered = belgianDrugs.filter(drug =>
                drug.name.toLowerCase().includes(query.toLowerCase()) ||
                drug.category.toLowerCase().includes(query.toLowerCase())
            );

            if (filtered.length === 0) {
                results.innerHTML = '<div class="autocomplete-item" style="color: var(--text-secondary);">Aucun m√©dicament trouv√©</div>';
                results.classList.add('active');
                return;
            }

            results.innerHTML = filtered.map(drug => `
                <div class="autocomplete-item" onclick="selectDrug('${drug.name}')">
                    <div class="drug-name">${drug.name}</div>
                    <div class="drug-details">${drug.category} - ${drug.indication}</div>
                </div>
            `).join('');

            results.classList.add('active');
        }

        // Close autocomplete when clicking outside
        document.addEventListener('click', function(event) {
            const autocomplete = document.querySelector('.autocomplete-container');
            if (!autocomplete.contains(event.target)) {
                document.getElementById('autocompleteResults').classList.remove('active');
            }
        });

        // Select drug from autocomplete
        function selectDrug(drugName) {
            const drug = belgianDrugs.find(d => d.name === drugName);

            if (selectedMedications.find(m => m.name === drugName)) {
                alert('‚ö†Ô∏è Ce m√©dicament est d√©j√† dans la prescription');
                return;
            }

            selectedMedications.push(drug);
            renderSelectedMedications();
            checkInteractions();

            document.getElementById('drugSearch').value = '';
            document.getElementById('autocompleteResults').classList.remove('active');
        }

        // Add suggestion from AI
        function addSuggestion(drugName) {
            const drug = belgianDrugs.find(d => d.name === drugName);

            if (!drug) return;

            if (selectedMedications.find(m => m.name === drugName)) {
                alert('‚ö†Ô∏è Ce m√©dicament est d√©j√† dans la prescription');
                return;
            }

            selectedMedications.push(drug);
            renderSelectedMedications();
            checkInteractions();
        }

        // Render selected medications
        function renderSelectedMedications() {
            const container = document.getElementById('selectedMedications');

            if (selectedMedications.length === 0) {
                container.innerHTML = '';
                return;
            }

            container.innerHTML = selectedMedications.map((drug, index) => `
                <div class="medication-item">
                    <div class="medication-header">
                        <div>
                            <div class="medication-name">${drug.name}</div>
                            <div style="font-size: 13px; color: var(--text-secondary); margin-top: 4px;">
                                ${drug.category} - ${drug.indication}
                            </div>
                        </div>
                        <button class="remove-btn" onclick="removeMedication(${index})">‚úï Retirer</button>
                    </div>
                    <div class="medication-dosage">
                        <input type="text" class="dosage-input" placeholder="Posologie" value="${drug.dosage}">
                        <input type="text" class="dosage-input" placeholder="Quantit√©" value="1 bo√Æte">
                        <button class="btn btn-secondary" style="padding: 8px; font-size: 13px;" onclick="showDrugInfo('${drug.name}')">
                            ‚ÑπÔ∏è Info
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Remove medication
        function removeMedication(index) {
            selectedMedications.splice(index, 1);
            renderSelectedMedications();
            checkInteractions();
        }

        // Check drug interactions
        function checkInteractions() {
            const warningsContainer = document.getElementById('warningsContainer');

            if (selectedMedications.length < 2) {
                warningsContainer.innerHTML = '';
                return;
            }

            // Check for known interactions
            const warnings = [];

            // Check AINS + Cortico√Ødes
            const hasNSAID = selectedMedications.some(d => d.category.includes('Anti-inflammatoire'));
            const hasCorticoid = selectedMedications.some(d => d.category.includes('Cortico√Øde'));
            if (hasNSAID && hasCorticoid) {
                warnings.push('‚ö†Ô∏è AINS + Cortico√Øde: Risque accru d\'ulc√®re gastrique. Surveiller et envisager protection gastrique.');
            }

            // Check multiple AINS
            const nsaidCount = selectedMedications.filter(d => d.category.includes('Anti-inflammatoire')).length;
            if (nsaidCount > 1) {
                warnings.push('‚ö†Ô∏è Plusieurs AINS prescrits: √âviter la co-prescription d\'AINS multiples (risque toxicit√©).');
            }

            // Check Tramadol + ISRS (would need patient medication data)
            const hasTramadol = selectedMedications.some(d => d.name.includes('Tramadol'));
            if (hasTramadol) {
                warnings.push('‚ÑπÔ∏è Tramadol prescrit: V√©rifier absence d\'ISRS/IMAO chez le patient (risque syndrome s√©rotoninergique).');
            }

            // Check antibiotics + anticoagulants (would need patient medication data)
            const hasAntibiotic = selectedMedications.some(d => d.category.includes('Antibiotique'));
            if (hasAntibiotic) {
                warnings.push('‚ÑπÔ∏è Antibiotique prescrit: Si patient sous anticoagulant oral, surveillance INR recommand√©e.');
            }

            // Check patient allergies
            const hasPenicillin = selectedMedications.some(d => d.name.includes('Amoxicillin') || d.name.includes('Amoxiclav'));
            if (hasPenicillin) {
                warnings.push('üö® ATTENTION: Patient allergique √† la p√©nicilline! M√©dicament contre-indiqu√©!');
            }

            if (warnings.length > 0) {
                warningsContainer.innerHTML = `
                    <div class="warnings-panel">
                        <div class="warning-title">
                            <span>‚ö†Ô∏è</span>
                            <span>Alertes et Interactions</span>
                        </div>
                        ${warnings.map(w => `<div class="warning-item">${w}</div>`).join('')}
                    </div>
                `;
            } else {
                warningsContainer.innerHTML = '';
            }
        }

        // Show drug info modal
        function showDrugInfo(drugName) {
            const drug = belgianDrugs.find(d => d.name === drugName);
            if (!drug) return;

            document.getElementById('modalDrugName').textContent = drug.name;
            document.getElementById('modalIndications').textContent = drug.indication;
            document.getElementById('modalContraindications').innerHTML =
                drug.contraindications.map(c => `<li>üö´ ${c}</li>`).join('');
            document.getElementById('modalSideEffects').textContent = drug.sideEffects;
            document.getElementById('modalDosage').textContent = drug.dosage;
            document.getElementById('modalInteractions').textContent = drug.interactions.join(', ');

            document.getElementById('drugInfoModal').classList.add('active');
        }

        // Close drug info modal
        function closeDrugInfo() {
            document.getElementById('drugInfoModal').classList.remove('active');
        }

        // Generate Recip-e prescription
        function generateRecipe() {
            if (selectedMedications.length === 0) {
                alert('‚ö†Ô∏è Veuillez ajouter au moins un m√©dicament √† la prescription');
                return;
            }

            // Check for penicillin allergy
            const hasPenicillin = selectedMedications.some(d =>
                d.name.includes('Amoxicillin') || d.name.includes('Amoxiclav')
            );

            if (hasPenicillin) {
                if (!confirm('üö® ATTENTION: Le patient est allergique √† la p√©nicilline!\n\nVoulez-vous vraiment continuer?')) {
                    return;
                }
            }

            showLoading('G√©n√©ration prescription Recip-e...');

            setTimeout(() => {
                hideLoading();

                // Generate Recip-e ID
                const recipeId = `BE-2025-${prescriptionCounter}-RXDE`;
                prescriptionCounter++;

                document.getElementById('recipeId').textContent = recipeId;
                document.getElementById('recipePanel').style.display = 'block';
                document.getElementById('recipePanel').scrollIntoView({ behavior: 'smooth' });

                // Add to history
                const historyPanel = document.querySelector('.history-panel');
                const today = new Date().toLocaleDateString('fr-BE');
                const drugsList = selectedMedications.map(d =>
                    `<strong>${d.name}</strong> - ${d.dosage}`
                ).join('<br>');

                const newHistoryItem = document.createElement('div');
                newHistoryItem.className = 'history-item';
                newHistoryItem.onclick = () => viewPrescription(recipeId);
                newHistoryItem.innerHTML = `
                    <div class="history-date">${today}</div>
                    <div class="history-drugs">${drugsList}</div>
                    <div class="history-recipe-id">ID: ${recipeId}</div>
                `;

                historyPanel.insertBefore(newHistoryItem, historyPanel.children[1]);

                alert('‚úÖ Prescription Recip-e g√©n√©r√©e avec succ√®s!\n\nID: ' + recipeId);
            }, 2500);
        }

        // Send to pharmacy
        function sendToPharmacy() {
            showLoading('Envoi vers la pharmacie via e-Health...');

            setTimeout(() => {
                hideLoading();
                alert('‚úÖ Prescription envoy√©e avec succ√®s!\n\nLe patient peut se rendre en pharmacie avec son QR code ou son num√©ro de prescription.');
            }, 2000);
        }

        // Print prescription
        function printPrescription() {
            alert('üñ®Ô∏è Impression de la prescription...\n\nFonctionnalit√© en cours de d√©veloppement.');
        }

        // Export PDF
        function exportPDF() {
            showLoading('G√©n√©ration du PDF...');

            setTimeout(() => {
                hideLoading();
                alert('üìÑ PDF g√©n√©r√© avec succ√®s!\n\nLe fichier a √©t√© t√©l√©charg√©.');
            }, 1500);
        }

        // View prescription
        function viewPrescription(recipeId) {
            alert('üìã Affichage de la prescription: ' + recipeId + '\n\nFonctionnalit√© en cours de d√©veloppement.');
        }

        // Save draft
        function saveDraft() {
            if (selectedMedications.length === 0) {
                alert('‚ö†Ô∏è Aucun m√©dicament √† sauvegarder');
                return;
            }

            showLoading('Sauvegarde du brouillon...');

            setTimeout(() => {
                hideLoading();
                alert('üíæ Brouillon sauvegard√© avec succ√®s!');
            }, 1000);
        }

        // Reset form
        function resetForm() {
            if (selectedMedications.length > 0) {
                if (!confirm('√ätes-vous s√ªr de vouloir r√©initialiser le formulaire?')) {
                    return;
                }
            }

            selectedMedications = [];
            renderSelectedMedications();
            checkInteractions();
            document.getElementById('drugSearch').value = '';
            document.getElementById('recipePanel').style.display = 'none';
        }

        // Dosage calculator
        function calculateDosage() {
            const weight = parseFloat(document.getElementById('patientWeight').value);
            const drug = document.getElementById('calcDrug').value;
            const resultDiv = document.getElementById('dosageResult');
            const resultValue = document.getElementById('resultValue');

            if (!weight || !drug) {
                resultDiv.style.display = 'none';
                return;
            }

            let dosage = '';

            switch(drug) {
                case 'ibuprofen':
                    const ibuprofenDose = Math.min(Math.round(weight * 10), 600);
                    dosage = `${ibuprofenDose} mg`;
                    break;
                case 'paracetamol':
                    const paracetamolDose = Math.min(Math.round(weight * 15), 1000);
                    dosage = `${paracetamolDose} mg`;
                    break;
                case 'amoxicillin':
                    const amoxDose = Math.round(weight * 25 / 250) * 250;
                    dosage = `${amoxDose} mg`;
                    break;
            }

            resultValue.textContent = dosage;
            resultDiv.style.display = 'block';
        }

        // Loading overlay
        function showLoading(text = 'Chargement...') {
            document.getElementById('loadingText').textContent = text;
            document.getElementById('loadingOverlay').classList.add('active');
        }

        function hideLoading() {
            document.getElementById('loadingOverlay').classList.remove('active');
        }

        // Theme Management
        function toggleTheme() {
            const html = document.documentElement;
            const themeToggle = document.getElementById('themeToggle');
            const currentTheme = html.getAttribute('data-theme');

            if (currentTheme === 'light') {
                html.setAttribute('data-theme', 'dark');
                themeToggle.textContent = 'üåô';
                localStorage.setItem('theme', 'dark');
            } else {
                html.setAttribute('data-theme', 'light');
                themeToggle.textContent = '‚òÄÔ∏è';
                localStorage.setItem('theme', 'light');
            }
        }

        // Load saved theme on page load
        function loadTheme() {
            const savedTheme = localStorage.getItem('theme') || 'dark';
            const html = document.documentElement;
            const themeToggle = document.getElementById('themeToggle');

            if (savedTheme === 'light') {
                html.setAttribute('data-theme', 'light');
                if (themeToggle) themeToggle.textContent = '‚òÄÔ∏è';
            } else {
                html.setAttribute('data-theme', 'dark');
                if (themeToggle) themeToggle.textContent = 'üåô';
            }
        }

        // Initialize theme on page load
        document.addEventListener('DOMContentLoaded', function() {
            loadTheme();

            // Set current date
            const today = new Date().toLocaleDateString('fr-BE');
            document.getElementById('prescriptionDate').textContent = today;
        });

        // Close modals on escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeDrugInfo();
            }
        });
    </script>
</body>
</html>
